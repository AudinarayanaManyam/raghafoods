{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Downloads/raagafoods%20%282%29/raagafoods/src/app/api/contact/route.js"],"sourcesContent":["// import { NextResponse } from 'next/server';\r\n// import nodemailer from 'nodemailer';\r\n\r\n// export async function POST(req: Request) {\r\n//   try {\r\n//     const { email, name, message } = await req.json();\r\n\r\n//     if (!email || !name || !message) {\r\n//       return NextResponse.json(\r\n//         { error: 'Missing required fields' },\r\n//         { status: 400 }\r\n//       );\r\n//     }\r\n\r\n//     if (!process.env.GMAIL_USER || !process.env.GMAIL_APP_PASSWORD) {\r\n//       console.error('Missing email configuration');\r\n//       return NextResponse.json(\r\n//         { error: 'Email service not configured' },\r\n//         { status: 500 }\r\n//       );\r\n//     }\r\n\r\n//     const transporter = nodemailer.createTransport({\r\n//       service: 'smtp.gmail.com',\r\n//       auth: {\r\n//         user: process.env.GMAIL_USER,\r\n//         pass: process.env.GMAIL_APP_PASSWORD,\r\n//       },\r\n//     });\r\n\r\n//     await transporter.sendMail({\r\n//       from: `\"Raaga Foods\" <${process.env.GMAIL_USER}>`,\r\n//       to: process.env.CONTACT_EMAIL ,\r\n//       replyTo: email,\r\n//       subject: `New Contact Message from ${name}`,\r\n//       html: `\r\n//         <h3>New Contact Message</h3>\r\n//         <p><strong>Name:</strong> ${name}</p>\r\n//         <p><strong>Email:</strong> ${email}</p>\r\n//         <p><strong>Message:</strong></p>\r\n//         <p>${message}</p>\r\n//       `,\r\n//     });\r\n\r\n//     return NextResponse.json({ success: true, message: 'Email sent successfully' });\r\n//   } catch (error) {\r\n//     console.error('Email error:', error);\r\n//     return NextResponse.json(\r\n//       { error: 'Failed to send email', details: error instanceof Error ? error.message : 'Unknown error' },\r\n//       { status: 500 }\r\n//     );\r\n//   }\r\n// }\r\n\r\n\r\n\r\nimport nodemailer from 'nodemailer';\r\n\r\n// Utility function to escape HTML\r\nfunction escapeHtml(text) {\r\n  const map = {\r\n    '&': '&amp;',\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '\"': '&quot;',\r\n    \"'\": '&#039;',\r\n  };\r\n  return text.replace(/[&<>\"']/g, (m) => map[m]);\r\n}\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const { name, email, message } = await request.json();\r\n\r\n    // Validate input\r\n    if (!name || !email ||  !message) {\r\n      return Response.json(\r\n        { success: false, error: 'Missing required fields' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Email validation\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) {\r\n      return Response.json(\r\n        { success: false, error: 'Invalid email address' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Validate SMTP configuration\r\n    if (!process.env.SMTP_HOST || !process.env.SMTP_USER || !process.env.SMTP_PASSWORD) {\r\n      console.error('SMTP configuration missing:', {\r\n        host: !!process.env.SMTP_HOST,\r\n        user: !!process.env.SMTP_USER,\r\n        pass: !!process.env.SMTP_PASSWORD,\r\n      });\r\n      return Response.json(\r\n        { success: false, error: 'Email service not configured. Please contact support.' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Configure SMTP transporter\r\n    const transporter = nodemailer.createTransport({\r\n      host: process.env.SMTP_HOST,\r\n      port: parseInt(process.env.SMTP_PORT || '587'),\r\n      secure: process.env.SMTP_SECURE === 'true',\r\n      auth: {\r\n        user: process.env.SMTP_USER,\r\n        pass: process.env.SMTP_PASSWORD,\r\n      },\r\n    });\r\n\r\n    // Email to admin\r\n    const adminMailOptions = {\r\n      from: process.env.SMTP_FROM_EMAIL,\r\n      to: process.env.ADMIN_EMAIL,\r\n      replyTo: email,\r\n      subject: `New Contact Form Submission from ${name}`,\r\n      html: `\r\n        <h2>New Contact Form Submission</h2>\r\n        <p><strong>Name:</strong> ${escapeHtml(name)}</p>\r\n        <p><strong>Email:</strong> ${escapeHtml(email)}</p>\r\n        \r\n        <p><strong>Message:</strong></p>\r\n        <p>${escapeHtml(message).replace(/\\n/g, '<br>')}</p>\r\n      `,\r\n    };\r\n\r\n    // Confirmation email to user\r\n    const userMailOptions = {\r\n      from: process.env.SMTP_FROM_EMAIL,\r\n      to: email,\r\n      subject: 'We received your message - Ragafoods',\r\n      html: `\r\n        <h2>Hello ${escapeHtml(name)},</h2>\r\n        <p>Thank you for reaching out to us! We have received your message and will get back to you shortly.</p>\r\n        <p><strong>Your Message:</strong></p>\r\n        <p>${escapeHtml(message).replace(/\\n/g, '<br>')}</p>\r\n        <hr>\r\n        <p>Best regards,<br>Ragafoods Team</p>\r\n      `,\r\n    };\r\n\r\n    // Send emails\r\n    await transporter.sendMail(adminMailOptions);\r\n    await transporter.sendMail(userMailOptions);\r\n\r\n    return Response.json(\r\n      { success: true, message: 'Email sent successfully' },\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    console.error('Email error:', error.message);\r\n    return Response.json(\r\n      { success: false, error: 'Failed to send email: ' + error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}